(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-13a484ee"],{"99af":function(t,a,e){"use strict";var s=e("23e7"),r=e("d039"),i=e("e8b5"),o=e("861d"),n=e("7b0b"),l=e("50c4"),c=e("8418"),d=e("65f0"),u=e("1dde"),m=e("b622"),p=e("2d00"),v=m("isConcatSpreadable"),f=9007199254740991,g="Maximum allowed index exceeded",h=p>=51||!r((function(){var t=[];return t[v]=!1,t.concat()[0]!==t})),_=u("concat"),C=function(t){if(!o(t))return!1;var a=t[v];return void 0!==a?!!a:i(t)},b=!h||!_;s({target:"Array",proto:!0,forced:b},{concat:function(t){var a,e,s,r,i,o=n(this),u=d(o,0),m=0;for(a=-1,s=arguments.length;a<s;a++)if(i=-1===a?o:arguments[a],C(i)){if(r=l(i.length),m+r>f)throw TypeError(g);for(e=0;e<r;e++,m++)e in i&&c(u,m,i[e])}else{if(m>=f)throw TypeError(g);c(u,m++,i)}return u.length=m,u}})},c416:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"p-4"},[t._m(0),e("div",{staticClass:"row flex-column-reverse flex-md-row",class:{"is-loading":t.isLoading}},[e("loading",{attrs:{active:t.isLoading,"is-full-page":!1},on:{"update:active":function(a){t.isLoading=a}}}),e("div",{staticClass:"col-md-7"},[e("h2",{staticClass:"section-title"},[t._v("訂單資訊")]),e("div",{staticClass:"card"},[e("form",{staticClass:"card-body",attrs:{action:""},on:{submit:function(a){return a.preventDefault(),t.createOrder(a)}}},[e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"name"}},[t._v("購買人姓名")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.name,expression:"form.user.name"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("name")},attrs:{type:"text",id:"name",name:"name"},domProps:{value:t.form.user.name},on:{input:function(a){a.target.composing||t.$set(t.form.user,"name",a.target.value)}}}),e("small",{staticClass:"invalid-feedback"},[t._v("請填寫姓名")])]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"email"}},[t._v("Email")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.email,expression:"form.user.email"},{name:"validate",rawName:"v-validate",value:"required|email",expression:"'required|email'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("email")},attrs:{type:"mail",id:"email",name:"email"},domProps:{value:t.form.user.email},on:{input:function(a){a.target.composing||t.$set(t.form.user,"email",a.target.value)}}}),e("small",{staticClass:"invalid-feedback"},[t._v(t._s(t.errors.first("email")))])]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"tel"}},[t._v("連絡電話")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.tel,expression:"form.user.tel"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("phone")},attrs:{type:"text",id:"tel",name:"phone"},domProps:{value:t.form.user.tel},on:{input:function(a){a.target.composing||t.$set(t.form.user,"tel",a.target.value)}}}),e("small",{staticClass:"invalid-feedback"},[t._v("請填寫連絡電話")])]),e("div",{staticClass:"form-group"},[e("label",{attrs:{for:"adress"}},[t._v("聯絡地址")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.form.user.address,expression:"form.user.address"},{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"form-control",class:{"is-invalid":t.errors.has("address")},attrs:{type:"text",id:"adress",name:"address"},domProps:{value:t.form.user.address},on:{input:function(a){a.target.composing||t.$set(t.form.user,"address",a.target.value)}}}),e("small",{staticClass:"invalid-feedback"},[t._v("請填寫地址")])]),e("div",{staticClass:"form-group"},[t._m(1),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.form.message,expression:"form.message"}],staticClass:"form-control",attrs:{id:"message",cols:"30",rows:"6"},domProps:{value:t.form.message},on:{input:function(a){a.target.composing||t.$set(t.form,"message",a.target.value)}}})]),t._m(2)])])]),e("div",{staticClass:"col-md-5"},[e("div",{staticClass:"sticky-top"},[e("h2",{staticClass:"section-title"},[t._v("商品明細")]),e("ul",{staticClass:"list-unstyled list-group mb-3"},[t._l(t.cartData.carts,(function(a){return e("li",{key:a.id,staticClass:"list-group-item d-flex justify-content-between align-items-center"},[e("div",{staticClass:"flex-shrink-1"},[e("h5",{staticClass:"font-weight-bold mb-0"},[t._v(t._s(a.product.title))]),a.coupon?e("div",{staticClass:"text-secondary"},[t._v(t._s(a.coupon.title))]):t._e(),e("small",{staticClass:"text-muted"},[t._v(t._s(t._f("moneyFilter")(a.product.price))+" X "+t._s(a.qty))])]),e("div",{staticClass:"text-nowrap"},[e("strong",{staticClass:"mr-3",class:{"text-primary":a.coupon}},[t._v("$"+t._s(t._f("moneyFilter")(a.final_total)))])])])})),e("li",{staticClass:"list-group-item"},[e("div",{staticClass:"input-group"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.coupon_code,expression:"coupon_code"}],staticClass:"form-control",attrs:{type:"text",placeholder:"winter30"},domProps:{value:t.coupon_code},on:{input:function(a){a.target.composing||(t.coupon_code=a.target.value)}}}),e("div",{staticClass:"input-group-append"},[e("button",{staticClass:"btn btn-secondary",attrs:{type:"button"},on:{click:t.applyCoupon}},[t._v("使用招待券")])])])]),e("li",{staticClass:"list-group-item text-right"},[e("strong",[t._v("總計：$"+t._s(t._f("moneyFilter")(t.cartData.total)))])]),t.cartData.total!==t.cartData.final_total?e("li",{staticClass:"list-group-item text-right"},[e("strong",{staticClass:"text-primary"},[t._v("優惠價：$"+t._s(t._f("moneyFilter")(t.cartData.final_total)))])]):t._e()],2)])])],1)])},r=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"form-wizard"},[e("div",{staticClass:"form-wizard-step"},[t._v("1.確認購物車")]),e("div",{staticClass:"form-wizard-step active"},[t._v("2.填寫訂單資訊")]),e("div",{staticClass:"form-wizard-step"},[t._v("3.完成購買")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("label",{attrs:{for:"message"}},[t._v(" 備註 "),e("small",{staticClass:"text-primary"},[t._v("此欄位非必填")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"text-right"},[e("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[t._v("送出訂單")])])}],i=(e("99af"),e("d81d"),{data:function(){return{cartData:{},form:{user:{name:"",email:"",tel:"",address:""},message:""},coupon_code:"",isLoading:!1}},methods:{getCart:function(){this.isLoading=!0;var t="".concat("https://vue-course-api.hexschool.io","/api/").concat("steam-store","/cart"),a=this;a.$http.get(t).then((function(t){a.cartData=t.data.data,a.isLoading=!1}))},applyCoupon:function(){this.isLoading=!0;var t={code:this.coupon_code},a="".concat("https://vue-course-api.hexschool.io","/api/").concat("steam-store","/coupon"),e=this;this.$http.post(a,{data:t}).then((function(t){t.data.success?e.$bus.$emit("message:push",t.data.message,"success"):e.$bus.$emit("message:push",t.data.message,"danger"),e.coupon_code="",e.getCart(),e.isLoading=!1}))},createOrder:function(){var t="".concat("https://vue-course-api.hexschool.io","/api/").concat("steam-store","/order"),a=this;a.$validator.validate().then((function(e){e&&(a.isLoading=!0,a.$http.post(t,{data:a.form}).then((function(t){t.data.success?(a.$bus.$emit("message:push",t.data.message,"success"),a.$router.push("/order_detail/".concat(t.data.orderId))):a.$bus.$emit("message:push",t.data.message,"danger"),a.$bus.$emit("cart:updateCart"),a.isLoading=!1})))}))},clearCartFromServer:function(t){this.isLoading=!0;var a=this;a.$http.all(a.cartData.carts.map((function(t){var e="".concat("https://vue-course-api.hexschool.io","/api/").concat("steam-store","/cart/").concat(t.id);return a.$http.delete(e)}))).then((function(){a.isLoading=!1,t()}))}},beforeRouteLeave:function(t,a,e){this.clearCartFromServer(e)},created:function(){this.getCart()}}),o=i,n=e("2877"),l=Object(n["a"])(o,s,r,!1,null,null,null);a["default"]=l.exports},d81d:function(t,a,e){"use strict";var s=e("23e7"),r=e("b727").map,i=e("1dde"),o=e("ae40"),n=i("map"),l=o("map");s({target:"Array",proto:!0,forced:!n||!l},{map:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})}}]);
//# sourceMappingURL=chunk-13a484ee.124fcacb.js.map